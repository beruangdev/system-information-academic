import{C as S,f as d}from"./choices-b42e1b7a.js";import{s as h}from"./selectStudents-68a567db.js";import{s as u}from"./selectSeasons-873b5e3f.js";import{s as m}from"./selectCourses-8a0dc8fa.js";import{f}from"./fetch-b8ff0b47.js";import"./_commonjsHelpers-725317a4.js";const b=({method:s})=>{const e="selectClassrooms";return{selectClassrooms:{el:null,url:null,urlSearch:{},data:[],staticQuery:{}},async initSelectClassrooms(){this[e].el=new S(`form.${s} [name="classroom_id"]`,{silent:!0,allowHTML:!1,searchResultLimit:10,renderSelectedChoices:"always",searchPlaceholderValue:"Cari kelas"}),this[e].url=this[e].el.passedElement.element.getAttribute("data-url"),this[e].urlSearch={},this[e].data=[],this.fetchClassrooms(),this[e].el.passedElement.element.addEventListener("search",async t=>{const i=t.detail.value;this[e].urlSearch={s_name:i},this.fetchClassrooms()},!1),this[e].el.passedElement.element.addEventListener("showDropdown",async()=>{this[e].el.input.element.value=this[e].urlSearch.s_name??""},!1)},fetchClassrooms:async function(){return new Promise((t,i)=>{this[e].fetchTimeout&&(clearTimeout(this[e].fetchTimeout),t([])),this[e].fetchTimeout=setTimeout(async()=>{let o=this[e].url;Object.keys(this[e].urlSearch).length>0&&(o+=`?${new URLSearchParams({...this[e].staticQuery,...this[e].urlSearch}).toString()}`),this[e].el.setChoices(await new Promise((n,_)=>{f(o).then(r=>{const{data:C}=r,c=C.map((l,T)=>({label:l.name,value:l.id,selected:l.id==this.body.classroom_id}));this[e].data=c,n(c)}).catch(r=>{console.log("ðŸš€ ~ file: selectClassrooms.js:90 ~ fetch ~ error:",r),n([])})}),"value","label",!0)},500)})},async fetchCurrentClassroom(){this[e].urlSearch={s_id:this.body.classroom_id},await this.fetchClassrooms()}}};window.editModal=y;function y(s){return{element:s,errors:null,body:{...a},editModalInit(){var e,t;this.initSelectStudents(),this.initSelectSeasons(),this.initSelectCourses(),this.initSelectClassrooms(),this.selectClassrooms.staticQuery={course_id:((t=(e=this.body)==null?void 0:e.course_id)==null?void 0:t.value)||""}},...d({method:"update"}),...h({method:"edit"}),...u({method:"edit"}),...m({method:"edit"}),...b({method:"edit"}),async editModalChangeHandler(e){e?(this.loading=!0,await this.fetchById(),await Promise.all([this.fetchCurrentStudent(),this.fetchCurrentSeason(),this.fetchCurrentCourse(),this.fetchCurrentClassroom()]),this.loading=!1):(this.body={...a},this.loading=!1)},updateSuccess(e){this.element.querySelector('button[aria-label="Close"]').click(),this.refreshTable()},async fetchById(){const e=await f(this.urlEdit),t={...e.user,...e};return this.body=t,t}}}const a={grade:0,student_id:"",course_id:"",classroom_id:"",season_id:"",user_id:""};window.pageDashboard=w;function w(s){return{element:s,loading:!1,data_id:null,urlEdit:null,urlUpdate:null,initPageDashboard(){},refreshTable(){const e=document.querySelector('button[aria-label="Refresh Table"]');e&&e.click()}}}window.createModal=p;function p(s){return{element:s,errors:null,body:{...a},createModalInit(){var e,t;this.initSelectStudents(),this.initSelectSeasons(),this.initSelectCourses(),this.initSelectClassrooms(),this.selectClassrooms.staticQuery={course_id:((t=(e=this.body)==null?void 0:e.course_id)==null?void 0:t.value)||""}},...d({method:"store"}),...h({method:"create"}),...u({method:"create"}),...m({method:"create"}),...b({method:"create"}),createModalChangeHandler(e){this.body={...a}},storeSuccess(e){this.element.querySelector('button[aria-label="Close"]').click(),this.refreshTable()}}}window.pageDashboard=g;function g(s){return{element:s,loading:!1,data_id:null,urlEdit:null,urlUpdate:null,initPageDashboard(){},refreshTable(){const e=document.querySelector('button[aria-label="Refresh Table"]');e&&e.click()}}}
